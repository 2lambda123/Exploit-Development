<?xml version="1.0" encoding="utf-8"?>
<Peach xmlns="http://peachfuzzer.com/2012/Peach" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://peachfuzzer.com/2012/Peach ../peach.xsd">
    <DataModel name="TestTemplate">
		<Blob />
    </DataModel>
	<StateModel name="State" initialState="Initial">
        <State name="Initial">
            <Action type="output">
                <DataModel ref="TestTemplate" />
                <!-- Directory from where to load test cases to mutate -->
                <Data name="data" fileName="C:\peach\samples/*.cur"/>
            </Action>
            <Action type="close" />
            <Action type="call" method="LaunchViewer" publisher="Peach.Agent"/>
        </State>
    </StateModel>
    <Agent name="WinAgent">
        <Monitor class="WindowsDebugger">
            <!-- Target process and command line to open "fuzzed" test case -->
            <Param name="CommandLine" value="C:\Program Files (x86)\FastStone Image Viewer\FSViewer.exe fuzz.cur" />
            <!-- WinDbg folder -->
            <Param name="WinDbgPath" value="C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\" />
            <Param name="StartOnCall" value="LaunchViewer" />
        </Monitor>
        <Monitor class="PageHeap">
            <!-- Target process name -->
            <Param name="Executable" value="FSViewer.exe"/>
            <!-- WinDbg folder -->
            <Param name="WinDbgPath" value="C:\Program Files (x86)\Windows Kits\10\Debuggers\x64\" />
        </Monitor>
    </Agent>
    <Test name="Default">
        <Agent ref="WinAgent" platform="windows"/>
        <StateModel ref="State"/>
        <Publisher class="File">
			<!-- "Fuzzed" Test Case Name-->
			<Param name="FileName" value="fuzz.cur" />
        </Publisher>
		<Logger class="Filesystem">
            <!-- Crashes Folder Location -->
            <Param name="Path" value="C:\crashes\" />
        </Logger>
    </Test>  
</Peach>